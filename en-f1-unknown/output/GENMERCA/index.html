<!DOCTYPE html><html><head><title>GENMERCA</title><meta charset="utf-8" /></head><body><svg width="736pt" height="704pt"
 viewBox="0.00 0.00 736.10 704.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 700.08)">
<title>GENMERCA</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-700.08 732.1,-700.08 732.1,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<ellipse fill="#ffffff" stroke="#000000" cx="153.85" cy="-678.08" rx="27" ry="18"/>
</g>
<!-- critter_p_proc -->
<g id="node2" class="node">
<title>critter_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="45.85" cy="-605.08" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;critter_p_proc -->
<g id="edge1" class="edge">
<title>start&#45;&gt;critter_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M135.04,-664.71C118.01,-653.51 92.7,-636.87 73.39,-624.18"/>
<polygon fill="#555555" stroke="#555555" points="75.73,-620.87 65.45,-618.3 71.88,-626.72 75.73,-620.87"/>
</g>
<!-- destroy_p_proc -->
<g id="node3" class="node">
<title>destroy_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="117.85" cy="-605.08" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;destroy_p_proc -->
<g id="edge2" class="edge">
<title>start&#45;&gt;destroy_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M145.5,-660.61C141.23,-652.19 135.93,-641.74 131.12,-632.24"/>
<polygon fill="#555555" stroke="#555555" points="133.8,-630.79 126.16,-623.46 127.56,-633.96 133.8,-630.79"/>
</g>
<!-- pickup_p_proc -->
<g id="node4" class="node">
<title>pickup_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="189.85" cy="-605.08" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;pickup_p_proc -->
<g id="edge3" class="edge">
<title>start&#45;&gt;pickup_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M162.2,-660.61C166.47,-652.19 171.77,-641.74 176.59,-632.24"/>
<polygon fill="#555555" stroke="#555555" points="180.15,-633.96 181.55,-623.46 173.91,-630.79 180.15,-633.96"/>
</g>
<!-- talk_p_proc -->
<g id="node5" class="node">
<title>talk_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="261.85" cy="-605.08" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;talk_p_proc -->
<g id="edge4" class="edge">
<title>start&#45;&gt;talk_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M172.67,-664.71C189.7,-653.51 215.01,-636.87 234.32,-624.18"/>
<polygon fill="#555555" stroke="#555555" points="235.82,-626.72 242.26,-618.3 231.98,-620.87 235.82,-626.72"/>
</g>
<!-- flee_dude -->
<g id="node6" class="node">
<title>flee_dude</title>
<ellipse fill="#ffffff" stroke="#000000" cx="45.85" cy="-520.03" rx="27" ry="18"/>
</g>
<!-- critter_p_proc&#45;&gt;flee_dude -->
<g id="edge5" class="edge">
<title>critter_p_proc&#45;&gt;flee_dude</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M45.85,-586.87C45.85,-576.03 45.85,-561.78 45.85,-549.3"/>
<polygon fill="#555555" stroke="#555555" points="49.35,-549.5 45.85,-539.5 42.35,-549.5 49.35,-549.5"/>
</g>
<!-- GenMercA00 -->
<g id="node7" class="node">
<title>GenMercA00</title>
<ellipse fill="#ffffff" stroke="#000000" cx="261.85" cy="-520.03" rx="132.23" ry="30.05"/>
<text text-anchor="middle" x="261.85" y="-523.98" font-family="Times,serif" font-size="14.00">Hello! What can I do for</text>
<text text-anchor="middle" x="261.85" y="-506.73" font-family="Times,serif" font-size="14.00">you?</text>
</g>
<!-- talk_p_proc&#45;&gt;GenMercA00 -->
<g id="edge6" class="edge">
<title>talk_p_proc&#45;&gt;GenMercA00</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M261.85,-586.87C261.85,-579.37 261.85,-570.24 261.85,-561.19"/>
<polygon fill="#555555" stroke="#555555" points="265.35,-561.32 261.85,-551.32 258.35,-561.32 265.35,-561.32"/>
</g>
<!-- GenMercA01 -->
<g id="node8" class="node">
<title>GenMercA01</title>
<ellipse fill="#ffffff" stroke="#000000" cx="261.85" cy="-401.48" rx="27" ry="18"/>
</g>
<!-- GenMercA00&#45;&gt;GenMercA01 -->
<g id="edge7" class="edge">
<title>GenMercA00&#45;&gt;GenMercA01</title>
<path fill="none" stroke="#997c00" d="M261.85,-489.62C261.85,-471.58 261.85,-448.61 261.85,-430.79"/>
<polygon fill="#997c00" stroke="#997c00" points="265.35,-430.92 261.85,-420.92 258.35,-430.92 265.35,-430.92"/>
<text text-anchor="middle" x="310.23" y="-450.05" font-family="Times,serif" font-size="14.00" fill="#997c00">Who are you?</text>
</g>
<!-- GenMercA02 -->
<g id="node9" class="node">
<title>GenMercA02</title>
<ellipse fill="#ffffff" stroke="#000000" cx="450.85" cy="-294.98" rx="27" ry="18"/>
</g>
<!-- GenMercA00&#45;&gt;GenMercA02 -->
<g id="edge8" class="edge">
<title>GenMercA00&#45;&gt;GenMercA02</title>
<path fill="none" stroke="#500099" d="M330.23,-494C341.88,-487.89 353.29,-480.58 362.85,-471.98 408.15,-431.21 433.05,-361.79 443.98,-323.45"/>
<polygon fill="#500099" stroke="#500099" points="447.56,-324.63 446.82,-314.07 440.81,-322.79 447.56,-324.63"/>
<text text-anchor="middle" x="496.35" y="-396.8" font-family="Times,serif" font-size="14.00" fill="#500099">What are you doing?</text>
</g>
<!-- GenMercA03 -->
<g id="node10" class="node">
<title>GenMercA03</title>
<ellipse fill="#ffffff" stroke="#000000" cx="644.85" cy="-401.48" rx="39.11" ry="18"/>
<text text-anchor="middle" x="644.85" y="-396.8" font-family="Times,serif" font-size="14.00">Aack!</text>
</g>
<!-- GenMercA00&#45;&gt;GenMercA03 -->
<g id="edge9" class="edge">
<title>GenMercA00&#45;&gt;GenMercA03</title>
<path fill="none" stroke="#009923" d="M355.19,-498.49C387.02,-490.9 422.68,-481.75 454.85,-471.98 508,-455.83 567.98,-433.11 606.08,-418.1"/>
<polygon fill="#009923" stroke="#009923" points="607.21,-421.02 615.22,-414.09 604.64,-414.51 607.21,-421.02"/>
<text text-anchor="middle" x="641.48" y="-458.68" font-family="Times,serif" font-size="14.00" fill="#009923">Yeah, gimme everything</text>
<text text-anchor="middle" x="641.48" y="-441.43" font-family="Times,serif" font-size="14.00" fill="#009923">you&#39;ve got.</text>
</g>
<!-- GenMercAEnd -->
<g id="node11" class="node">
<title>GenMercAEnd</title>
<ellipse fill="#ffffff" stroke="#000000" cx="151.85" cy="-103.24" rx="27" ry="18"/>
</g>
<!-- GenMercA00&#45;&gt;GenMercAEnd -->
<g id="edge10" class="edge">
<title>GenMercA00&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#99000a" d="M147.86,-504.45C103.92,-496.8 60.29,-486.04 43.85,-471.98 5.32,-438.99 12.12,-415.34 2.85,-365.48 -15.69,-265.68 79.85,-166.81 126.9,-125"/>
<polygon fill="#99000a" stroke="#99000a" points="128.85,-127.08 134.09,-117.87 124.25,-121.8 128.85,-127.08"/>
<text text-anchor="middle" x="19.35" y="-343.55" font-family="Times,serif" font-size="14.00" fill="#99000a">Lub!</text>
</g>
<!-- GenMercA00&#45;&gt;GenMercAEnd -->
<g id="edge11" class="edge">
<title>GenMercA00&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#003699" d="M202.63,-492.82C154.25,-467.81 89.2,-425.1 59.6,-365.48 17.92,-281.49 93.21,-173.93 131.5,-127.4"/>
<polygon fill="#003699" stroke="#003699" points="134.64,-130.1 138.4,-120.19 129.28,-125.59 134.64,-130.1"/>
<text text-anchor="middle" x="146.48" y="-352.18" font-family="Times,serif" font-size="14.00" fill="#003699">Yeah, gimme everything</text>
<text text-anchor="middle" x="146.48" y="-334.93" font-family="Times,serif" font-size="14.00" fill="#003699">you&#39;ve got.</text>
</g>
<!-- GenMercA01&#45;&gt;GenMercA02 -->
<g id="edge12" class="edge">
<title>GenMercA01&#45;&gt;GenMercA02</title>
<path fill="none" stroke="#639900" d="M261.29,-383.17C261.78,-367.18 265.24,-343.99 279.85,-330.98 301.64,-311.58 381.71,-320.62 409.85,-312.98 412.85,-312.16 415.92,-311.18 418.97,-310.11"/>
<polygon fill="#639900" stroke="#639900" points="420.01,-313.07 428.09,-306.21 417.5,-306.54 420.01,-313.07"/>
<text text-anchor="middle" x="353.35" y="-343.55" font-family="Times,serif" font-size="14.00" fill="#639900">What are you doing?</text>
</g>
<!-- GenMercA01&#45;&gt;GenMercAEnd -->
<g id="edge13" class="edge">
<title>GenMercA01&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#990090" d="M255.62,-383.7C237.44,-334.73 184.31,-191.64 161.95,-131.43"/>
<polygon fill="#990090" stroke="#990090" points="164.91,-130.35 158.15,-122.2 158.35,-132.79 164.91,-130.35"/>
<text text-anchor="middle" x="314.35" y="-298.93" font-family="Times,serif" font-size="14.00" fill="#990090">Hello! What can I do for</text>
<text text-anchor="middle" x="314.35" y="-281.68" font-family="Times,serif" font-size="14.00" fill="#990090">you?</text>
</g>
<!-- GenMercA02&#45;&gt;GenMercAEnd -->
<g id="edge15" class="edge">
<title>GenMercA02&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#994900" d="M429.09,-283.74C422.98,-281.2 416.25,-278.71 409.85,-276.98 353.13,-261.59 330.14,-287.67 278.85,-258.98 264.47,-250.93 201.7,-169.88 170.12,-128.41"/>
<polygon fill="#994900" stroke="#994900" points="172.37,-126.57 163.53,-120.73 166.79,-130.81 172.37,-126.57"/>
<text text-anchor="middle" x="364.35" y="-245.68" font-family="Times,serif" font-size="14.00" fill="#994900">Hello! What can I do for</text>
<text text-anchor="middle" x="364.35" y="-228.43" font-family="Times,serif" font-size="14.00" fill="#994900">you?</text>
</g>
<!-- GenMercA04 -->
<g id="node12" class="node">
<title>GenMercA04</title>
<ellipse fill="#ffffff" stroke="#000000" cx="461.85" cy="-103.24" rx="125.87" ry="103.24"/>
<text text-anchor="middle" x="461.85" y="-158.94" font-family="Times,serif" font-size="14.00">Sorry, but I don&#39;t think</text>
<text text-anchor="middle" x="461.85" y="-141.69" font-family="Times,serif" font-size="14.00">I can trust you.</text>
<text text-anchor="middle" x="461.85" y="-124.44" font-family="Times,serif" font-size="14.00">&#45;&#45;&#45;</text>
<text text-anchor="middle" x="461.85" y="-107.19" font-family="Times,serif" font-size="14.00">Sorry, this company is</text>
<text text-anchor="middle" x="461.85" y="-89.94" font-family="Times,serif" font-size="14.00">already full.</text>
<text text-anchor="middle" x="461.85" y="-72.69" font-family="Times,serif" font-size="14.00">&#45;&#45;&#45;</text>
<text text-anchor="middle" x="461.85" y="-55.44" font-family="Times,serif" font-size="14.00">Sorry, this company is</text>
<text text-anchor="middle" x="461.85" y="-38.19" font-family="Times,serif" font-size="14.00">already full.</text>
</g>
<!-- GenMercA02&#45;&gt;GenMercA04 -->
<g id="edge14" class="edge">
<title>GenMercA02&#45;&gt;GenMercA04</title>
<path fill="none" stroke="#009976" d="M451.85,-276.8C452.68,-262.48 453.94,-240.73 455.29,-217.44"/>
<polygon fill="#009976" stroke="#009976" points="458.83,-217.84 455.92,-207.65 451.84,-217.43 458.83,-217.84"/>
<text text-anchor="middle" x="527.23" y="-245.68" font-family="Times,serif" font-size="14.00" fill="#009976">Do you mind if I join</text>
<text text-anchor="middle" x="527.23" y="-228.43" font-family="Times,serif" font-size="14.00" fill="#009976">you?</text>
</g>
</g>
</svg>
<script>window.Codes = {"start":"if (not(initialized)) then begin\n  critter_add_trait(self_obj, 1, 6, 2);\n  critter_add_trait(self_obj, 1, 5, 50);\n  name_index := 105 + global_var(335);\n  job_index := 109 + global_var(335);\n  hostile := global_var(334);\n  set_global_var(335, global_var(335) + 1);\n  initialized := 1;\nend\nif (script_action == 12) then begin\n  call critter_p_proc;\nend\nelse begin\n  if (script_action == 18) then begin\n    call destroy_p_proc;\n  end\n  else begin\n    if (script_action == 4) then begin\n      call pickup_p_proc;\n    end\n    else begin\n      if (script_action == 11) then begin\n        call talk_p_proc;\n      end\n    end\n  end\nend\n","critter_p_proc":"if (scared and (tile_distance_objs(self_obj, dude_obj) < 8)) then begin\n  call flee_dude;\nend\nelse begin\n  if (hostile) then begin\n    hostile := 0;\n    scared := 1;\n    attack_complex(dude_obj, 0, 1, 0, 0, 30000, 0, 0);\n  end\nend\n","destroy_p_proc":"if (source_obj == dude_obj) then begin\n  set_global_var(334, 1);\n  if (source_obj == dude_obj) then begin\n    if (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1))) then begin\n      set_global_var(156, 1);\n      set_global_var(157, 0);\n    end\n    if (((global_var(160) + global_var(159)) >= 25) and ((global_var(160) > (3 * global_var(159))) or (global_var(157) == 1))) then begin\n      set_global_var(157, 1);\n      set_global_var(156, 0);\n    end\n    set_global_var(159, global_var(159) + 1);\n    if ((global_var(159) % 2) == 0) then begin\n      set_global_var(155, global_var(155) - 1);\n    end\n  end\nend\n","pickup_p_proc":"if (scared == 0) then begin\n  hostile := 1;\n  set_global_var(334, 1);\nend\n","talk_p_proc":"if (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1))) then begin\n  set_global_var(156, 1);\n  set_global_var(157, 0);\nend\nif (scared) then begin\n  float_msg(self_obj, message_str(669, random(100, 105)), 2);\nend\nelse begin\n  start_gdialog(752, self_obj, 4, -1, -1);\n  gsay_start;\n  call GenMercA00;\n  gsay_end;\n  end_dialogue;\nend\n","GenMercA00":"gsay_reply(752, 100);\ngiq_option(4, 752, 101, GenMercA01, 50);\ngiq_option(4, 752, 102, GenMercA02, 50);\nif (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1))) then begin\n  giq_option(4, 752, 103, GenMercA03, 51);\nend\ngiq_option(-3, 752, 104, GenMercAEnd, 50);\ngiq_option(4, 634, 103, GenMercAEnd, 50);\n","GenMercA01":"gsay_reply(752, name_index);\ngiq_option(4, 752, 102, GenMercA02, 50);\ngiq_option(4, 634, 100, GenMercAEnd, 50);\n","GenMercA02":"gsay_reply(752, job_index);\ngiq_option(4, 752, 114, GenMercA04, 50);\ngiq_option(4, 634, 100, GenMercAEnd, 50);\n","GenMercA03":"scared := 1;\ngsay_message(752, 113, 51);\n","GenMercA04":"if (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1)) or (global_var(158) > 2) or (global_var(155) < -20)) then begin\n  gsay_message(752, 117, 51);\nend\nelse begin\n  if (is_success(roll_vs_skill(dude_obj, 14, 0))) then begin\n    gsay_message(752, 116, 50);\n  end\n  else begin\n    gsay_message(752, 116, 50);\n  end\nend\n","GenMercAEnd":"[]","flee_dude":"variable LVar0 := 0;\nvariable LVar1 := 0;\nvariable LVar2 := 0;\nwhile(LVar1 < 5) do begin\n  if (tile_distance(tile_num(dude_obj), tile_num_in_direction(tile_num(self_obj), LVar1, 3)) > LVar2) then begin\n    LVar0 := tile_num_in_direction(tile_num(self_obj), LVar1, 3);\n    LVar2 := tile_distance(tile_num(dude_obj), LVar0);\n  end\n  LVar1 := LVar1 + 1;\nend\nanimate_move_obj_to_tile(self_obj, LVar0, 1);\n"}</script></body><script src="../jquery.js"></script><script src="../underscore.js"></script><script>(function() {
  var downAt, hideCode, nodes, positionCode, showCode;

  $('svg').attr('unselectable', 'on').css({
    '-moz-user-select': '-moz-none',
    '-moz-user-select': 'none',
    '-o-user-select': 'none',
    '-khtml-user-select': 'none',
    '-webkit-user-select': 'none',
    '-ms-user-select': 'none',
    'user-select': 'none'
  }).bind('selectstart', function() {
    return false;
  });

  $('<div/>', {
    id: 'thecode'
  }).appendTo('body');

  $('#thecode').css({
    'pointer-events': 'none',
    background: 'white',
    padding: '1em',
    outline: 'solid gray 1px',
    'white-space': 'pre',
    position: 'fixed',
    left: 0,
    top: 0
  });

  showCode = function(name, code, x, y) {
    $('#thecode').show();
    $('#thecode').text("# " + name + "\n" + code);
    return positionCode(x, y);
  };

  hideCode = function() {
    return $('#thecode').hide();
  };

  positionCode = function(x, y) {
    return $('#thecode').css({
      left: x,
      top: y
    });
  };

  nodes = $('.node');

  _.each(nodes, function(node) {
    var nodeName;
    nodeName = $(node).find('title').text();
    $(node).mousemove(function(e) {
      return showCode(nodeName, Codes[nodeName], e.clientX, e.clientY);
    });
    return $(node).mouseleave(function() {
      return hideCode();
    });
  });

  $('svg title').remove();

  downAt = null;

  $('svg').mousedown(function(e) {
    var x, y;
    x = e.pageX;
    y = e.pageY;
    return downAt = {
      x: x,
      y: y
    };
  });

  $('svg').mousemove(function(e) {
    var delta, x, y;
    if (!downAt) {
      return;
    }
    x = e.pageX;
    y = e.pageY;
    delta = {
      x: x - downAt.x,
      y: y - downAt.y
    };
    window.scrollBy(-delta.x, -delta.y);
    return false;
  });

  $('svg').mouseup(function(e) {
    return downAt = null;
  });

  $('svg').mouseleave(function(e) {
    return downAt = null;
  });

}).call(this);
</script></html>