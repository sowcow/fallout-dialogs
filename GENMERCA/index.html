<!DOCTYPE html><html><head><title>GENMERCA</title><meta charset="utf-8" /></head><body><svg width="637pt" height="659pt"
 viewBox="0.00 0.00 637.00 658.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 654.759)">
<title>GENMERCA</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-654.759 633,-654.759 633,4 -4,4"/>
<!-- start -->
<g id="node1" class="node"><title>start</title>
<ellipse fill="#ffffff" stroke="#000000" cx="135" cy="-632.759" rx="27" ry="18"/>
</g>
<!-- critter_p_proc -->
<g id="node2" class="node"><title>critter_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="27" cy="-559.759" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;critter_p_proc -->
<g id="edge1" class="edge"><title>start&#45;&gt;critter_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M116.188,-619.392C98.9979,-608.091 73.3816,-591.251 54.0067,-578.514"/>
<polygon fill="#555555" stroke="#555555" points="55.8753,-575.554 45.5966,-572.985 52.03,-581.403 55.8753,-575.554"/>
</g>
<!-- destroy_p_proc -->
<g id="node3" class="node"><title>destroy_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="99" cy="-559.759" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;destroy_p_proc -->
<g id="edge2" class="edge"><title>start&#45;&gt;destroy_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M126.65,-615.292C122.288,-606.689 116.853,-595.97 111.959,-586.317"/>
<polygon fill="#555555" stroke="#555555" points="114.948,-584.474 107.304,-577.137 108.705,-587.639 114.948,-584.474"/>
</g>
<!-- pickup_p_proc -->
<g id="node4" class="node"><title>pickup_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="171" cy="-559.759" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;pickup_p_proc -->
<g id="edge3" class="edge"><title>start&#45;&gt;pickup_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M143.35,-615.292C147.712,-606.689 153.147,-595.97 158.041,-586.317"/>
<polygon fill="#555555" stroke="#555555" points="161.295,-587.639 162.696,-577.137 155.052,-584.474 161.295,-587.639"/>
</g>
<!-- talk_p_proc -->
<g id="node5" class="node"><title>talk_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="243" cy="-559.759" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;talk_p_proc -->
<g id="edge4" class="edge"><title>start&#45;&gt;talk_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M153.812,-619.392C171.002,-608.091 196.618,-591.251 215.993,-578.514"/>
<polygon fill="#555555" stroke="#555555" points="217.97,-581.403 224.403,-572.985 214.125,-575.554 217.97,-581.403"/>
</g>
<!-- flee_dude -->
<g id="node6" class="node"><title>flee_dude</title>
<ellipse fill="#ffffff" stroke="#000000" cx="27" cy="-477.889" rx="27" ry="18"/>
</g>
<!-- critter_p_proc&#45;&gt;flee_dude -->
<g id="edge5" class="edge"><title>critter_p_proc&#45;&gt;flee_dude</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M27,-541.429C27,-531.102 27,-517.767 27,-506.066"/>
<polygon fill="#555555" stroke="#555555" points="30.5001,-505.912 27,-495.912 23.5001,-505.912 30.5001,-505.912"/>
</g>
<!-- GenMercA00 -->
<g id="node7" class="node"><title>GenMercA00</title>
<ellipse fill="#ffffff" stroke="#000000" cx="243" cy="-477.889" rx="111.946" ry="26.7407"/>
<text text-anchor="middle" x="243" y="-481.689" font-family="Times,serif" font-size="14.00">Hello! What can I do for</text>
<text text-anchor="middle" x="243" y="-466.689" font-family="Times,serif" font-size="14.00">you?</text>
</g>
<!-- talk_p_proc&#45;&gt;GenMercA00 -->
<g id="edge6" class="edge"><title>talk_p_proc&#45;&gt;GenMercA00</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M243,-541.429C243,-533.695 243,-524.275 243,-515.118"/>
<polygon fill="#555555" stroke="#555555" points="246.5,-514.993 243,-504.993 239.5,-514.994 246.5,-514.993"/>
</g>
<!-- GenMercA01 -->
<g id="node8" class="node"><title>GenMercA01</title>
<ellipse fill="#ffffff" stroke="#000000" cx="243" cy="-367.019" rx="27" ry="18"/>
</g>
<!-- GenMercA00&#45;&gt;GenMercA01 -->
<g id="edge7" class="edge"><title>GenMercA00&#45;&gt;GenMercA01</title>
<path fill="none" stroke="#990020" d="M243,-450.812C243,-434.093 243,-412.422 243,-395.445"/>
<polygon fill="#990020" stroke="#990020" points="246.5,-395.066 243,-385.066 239.5,-395.066 246.5,-395.066"/>
<text text-anchor="middle" x="283.5" y="-414.319" font-family="Times,serif" font-size="14.00" fill="#990020">Who are you?</text>
</g>
<!-- GenMercA02 -->
<g id="node9" class="node"><title>GenMercA02</title>
<ellipse fill="#ffffff" stroke="#000000" cx="403" cy="-265.019" rx="27" ry="18"/>
</g>
<!-- GenMercA00&#45;&gt;GenMercA02 -->
<g id="edge8" class="edge"><title>GenMercA00&#45;&gt;GenMercA02</title>
<path fill="none" stroke="#004d99" d="M298.983,-454.365C309.442,-448.474 319.684,-441.377 328,-433.019 367.583,-393.238 388.242,-328.887 397.252,-292.785"/>
<polygon fill="#004d99" stroke="#004d99" points="400.677,-293.508 399.586,-282.97 393.867,-291.888 400.677,-293.508"/>
<text text-anchor="middle" x="440" y="-363.319" font-family="Times,serif" font-size="14.00" fill="#004d99">What are you doing?</text>
</g>
<!-- GenMercA03 -->
<g id="node10" class="node"><title>GenMercA03</title>
<ellipse fill="#ffffff" stroke="#000000" cx="566" cy="-367.019" rx="33.5952" ry="18"/>
<text text-anchor="middle" x="566" y="-363.319" font-family="Times,serif" font-size="14.00">Aack!</text>
</g>
<!-- GenMercA00&#45;&gt;GenMercA03 -->
<g id="edge9" class="edge"><title>GenMercA00&#45;&gt;GenMercA03</title>
<path fill="none" stroke="#7a9900" d="M320.847,-458.418C348.59,-451.251 379.911,-442.486 408,-433.019 451.558,-418.339 500.279,-397.613 531.95,-383.54"/>
<polygon fill="#7a9900" stroke="#7a9900" points="533.508,-386.678 541.207,-379.401 530.65,-380.288 533.508,-386.678"/>
<text text-anchor="middle" x="557.5" y="-421.819" font-family="Times,serif" font-size="14.00" fill="#7a9900">Yeah, gimme everything</text>
<text text-anchor="middle" x="557.5" y="-406.819" font-family="Times,serif" font-size="14.00" fill="#7a9900">you&#39;ve got.</text>
</g>
<!-- GenMercAEnd -->
<g id="node11" class="node"><title>GenMercAEnd</title>
<ellipse fill="#ffffff" stroke="#000000" cx="142" cy="-90.5097" rx="27" ry="18"/>
</g>
<!-- GenMercA00&#45;&gt;GenMercAEnd -->
<g id="edge10" class="edge"><title>GenMercA00&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#8c0099" d="M148.315,-463.566C108.732,-456.274 68.5614,-446.045 54,-433.019 18.1698,-400.968 26.1165,-378.403 18,-331.019 2.88085,-242.754 79.558,-152.696 119.313,-112.786"/>
<polygon fill="#8c0099" stroke="#8c0099" points="122.058,-114.995 126.734,-105.488 117.15,-110.004 122.058,-114.995"/>
<text text-anchor="middle" x="32" y="-312.319" font-family="Times,serif" font-size="14.00" fill="#8c0099">Lub!</text>
</g>
<!-- GenMercA00&#45;&gt;GenMercAEnd -->
<g id="edge11" class="edge"><title>GenMercA00&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#00995f" d="M197.832,-453.207C156.661,-428.792 98.4984,-386.497 73,-331.019 38.4259,-255.795 94.0669,-159.237 124.39,-115.246"/>
<polygon fill="#00995f" stroke="#00995f" points="127.355,-117.115 130.259,-106.927 121.635,-113.08 127.355,-117.115"/>
<text text-anchor="middle" x="144.5" y="-319.819" font-family="Times,serif" font-size="14.00" fill="#00995f">Yeah, gimme everything</text>
<text text-anchor="middle" x="144.5" y="-304.819" font-family="Times,serif" font-size="14.00" fill="#00995f">you&#39;ve got.</text>
</g>
<!-- GenMercA01&#45;&gt;GenMercA02 -->
<g id="edge12" class="edge"><title>GenMercA01&#45;&gt;GenMercA02</title>
<path fill="none" stroke="#993200" d="M242.669,-348.795C243.37,-333.971 246.879,-313.116 260,-301.019 293.844,-269.815 317.808,-295.912 362,-283.019 365.181,-282.091 368.45,-280.995 371.688,-279.814"/>
<polygon fill="#993200" stroke="#993200" points="373.151,-283 381.188,-276.097 370.6,-276.481 373.151,-283"/>
<text text-anchor="middle" x="320" y="-312.319" font-family="Times,serif" font-size="14.00" fill="#993200">What are you doing?</text>
</g>
<!-- GenMercA01&#45;&gt;GenMercAEnd -->
<g id="edge13" class="edge"><title>GenMercA01&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#060099" d="M236.834,-349.261C219.819,-303.016 172.113,-173.355 151.588,-117.569"/>
<polygon fill="#060099" stroke="#060099" points="154.823,-116.225 148.085,-108.049 148.254,-118.642 154.823,-116.225"/>
<text text-anchor="middle" x="284" y="-268.819" font-family="Times,serif" font-size="14.00" fill="#060099">Hello! What can I do for</text>
<text text-anchor="middle" x="284" y="-253.819" font-family="Times,serif" font-size="14.00" fill="#060099">you?</text>
</g>
<!-- GenMercA02&#45;&gt;GenMercAEnd -->
<g id="edge15" class="edge"><title>GenMercA02&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#990053" d="M381.188,-253.941C375.076,-251.403 368.362,-248.875 362,-247.019 317.808,-234.127 299.992,-251.818 260,-229.019 247.233,-221.741 190.231,-151.819 160.375,-114.586"/>
<polygon fill="#990053" stroke="#990053" points="163.078,-112.362 154.098,-106.74 157.612,-116.735 163.078,-112.362"/>
<text text-anchor="middle" x="331" y="-217.819" font-family="Times,serif" font-size="14.00" fill="#990053">Hello! What can I do for</text>
<text text-anchor="middle" x="331" y="-202.819" font-family="Times,serif" font-size="14.00" fill="#990053">you?</text>
</g>
<!-- GenMercA04 -->
<g id="node12" class="node"><title>GenMercA04</title>
<ellipse fill="#ffffff" stroke="#000000" cx="414" cy="-90.5097" rx="102.561" ry="90.5193"/>
<text text-anchor="middle" x="414" y="-139.31" font-family="Times,serif" font-size="14.00">Sorry, but I don&#39;t think</text>
<text text-anchor="middle" x="414" y="-124.31" font-family="Times,serif" font-size="14.00">I can trust you.</text>
<text text-anchor="middle" x="414" y="-109.31" font-family="Times,serif" font-size="14.00">&#45;&#45;&#45;</text>
<text text-anchor="middle" x="414" y="-94.3097" font-family="Times,serif" font-size="14.00">Sorry, this company is</text>
<text text-anchor="middle" x="414" y="-79.3097" font-family="Times,serif" font-size="14.00">already full.</text>
<text text-anchor="middle" x="414" y="-64.3097" font-family="Times,serif" font-size="14.00">&#45;&#45;&#45;</text>
<text text-anchor="middle" x="414" y="-49.3097" font-family="Times,serif" font-size="14.00">Sorry, this company is</text>
<text text-anchor="middle" x="414" y="-34.3097" font-family="Times,serif" font-size="14.00">already full.</text>
</g>
<!-- GenMercA02&#45;&gt;GenMercA04 -->
<g id="edge14" class="edge"><title>GenMercA02&#45;&gt;GenMercA04</title>
<path fill="none" stroke="#279900" d="M404.095,-246.848C404.971,-233.102 406.279,-212.6 407.658,-190.963"/>
<polygon fill="#279900" stroke="#279900" points="411.153,-191.165 408.296,-180.962 404.167,-190.719 411.153,-191.165"/>
<text text-anchor="middle" x="469" y="-217.819" font-family="Times,serif" font-size="14.00" fill="#279900">Do you mind if I join</text>
<text text-anchor="middle" x="469" y="-202.819" font-family="Times,serif" font-size="14.00" fill="#279900">you?</text>
</g>
</g>
</svg>
<script>window.Codes = {"start":"if (not(initialized)) then begin\n  critter_add_trait(self_obj, 1, 6, 2);\n  critter_add_trait(self_obj, 1, 5, 50);\n  name_index := 105 + global_var(335);\n  job_index := 109 + global_var(335);\n  hostile := global_var(334);\n  set_global_var(335, global_var(335) + 1);\n  initialized := 1;\nend\nif (script_action == 12) then begin\n  call critter_p_proc;\nend\nelse begin\n  if (script_action == 18) then begin\n    call destroy_p_proc;\n  end\n  else begin\n    if (script_action == 4) then begin\n      call pickup_p_proc;\n    end\n    else begin\n      if (script_action == 11) then begin\n        call talk_p_proc;\n      end\n    end\n  end\nend\n","critter_p_proc":"if (scared and (tile_distance_objs(self_obj, dude_obj) < 8)) then begin\n  call flee_dude;\nend\nelse begin\n  if (hostile) then begin\n    hostile := 0;\n    scared := 1;\n    attack_complex(dude_obj, 0, 1, 0, 0, 30000, 0, 0);\n  end\nend\n","destroy_p_proc":"if (source_obj == dude_obj) then begin\n  set_global_var(334, 1);\n  if (source_obj == dude_obj) then begin\n    if (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1))) then begin\n      set_global_var(156, 1);\n      set_global_var(157, 0);\n    end\n    if (((global_var(160) + global_var(159)) >= 25) and ((global_var(160) > (3 * global_var(159))) or (global_var(157) == 1))) then begin\n      set_global_var(157, 1);\n      set_global_var(156, 0);\n    end\n    set_global_var(159, global_var(159) + 1);\n    if ((global_var(159) % 2) == 0) then begin\n      set_global_var(155, global_var(155) - 1);\n    end\n  end\nend\n","pickup_p_proc":"if (scared == 0) then begin\n  hostile := 1;\n  set_global_var(334, 1);\nend\n","talk_p_proc":"if (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1))) then begin\n  set_global_var(156, 1);\n  set_global_var(157, 0);\nend\nif (scared) then begin\n  float_msg(self_obj, message_str(669, random(100, 105)), 2);\nend\nelse begin\n  start_gdialog(752, self_obj, 4, -1, -1);\n  gsay_start;\n  call GenMercA00;\n  gsay_end;\n  end_dialogue;\nend\n","GenMercA00":"gsay_reply(752, 100);\ngiq_option(4, 752, 101, GenMercA01, 50);\ngiq_option(4, 752, 102, GenMercA02, 50);\nif (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1))) then begin\n  giq_option(4, 752, 103, GenMercA03, 51);\nend\ngiq_option(-3, 752, 104, GenMercAEnd, 50);\ngiq_option(4, 634, 103, GenMercAEnd, 50);\n","GenMercA01":"gsay_reply(752, name_index);\ngiq_option(4, 752, 102, GenMercA02, 50);\ngiq_option(4, 634, 100, GenMercAEnd, 50);\n","GenMercA02":"gsay_reply(752, job_index);\ngiq_option(4, 752, 114, GenMercA04, 50);\ngiq_option(4, 634, 100, GenMercAEnd, 50);\n","GenMercA03":"scared := 1;\ngsay_message(752, 113, 51);\n","GenMercA04":"if (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1)) or (global_var(158) > 2) or (global_var(155) < -20)) then begin\n  gsay_message(752, 117, 51);\nend\nelse begin\n  if (is_success(roll_vs_skill(dude_obj, 14, 0))) then begin\n    gsay_message(752, 116, 50);\n  end\n  else begin\n    gsay_message(752, 116, 50);\n  end\nend\n","GenMercAEnd":"[]","flee_dude":"variable LVar0 := 0;\nvariable LVar1 := 0;\nvariable LVar2 := 0;\nwhile(LVar1 < 5) do begin\n  if (tile_distance(tile_num(dude_obj), tile_num_in_direction(tile_num(self_obj), LVar1, 3)) > LVar2) then begin\n    LVar0 := tile_num_in_direction(tile_num(self_obj), LVar1, 3);\n    LVar2 := tile_distance(tile_num(dude_obj), LVar0);\n  end\n  LVar1 := LVar1 + 1;\nend\nanimate_move_obj_to_tile(self_obj, LVar0, 1);\n"}</script></body><script src="../jquery.js"></script><script src="../underscore.js"></script><script type="text/javascript">(function() {
  var downAt, hideCode, nodes, positionCode, showCode;

  $('svg').attr('unselectable', 'on').css({
    '-moz-user-select': '-moz-none',
    '-moz-user-select': 'none',
    '-o-user-select': 'none',
    '-khtml-user-select': 'none',
    '-webkit-user-select': 'none',
    '-ms-user-select': 'none',
    'user-select': 'none'
  }).bind('selectstart', function() {
    return false;
  });

  $('<div/>', {
    id: 'thecode'
  }).appendTo('body');

  $('#thecode').css({
    'pointer-events': 'none',
    background: 'white',
    padding: '1em',
    outline: 'solid gray 1px',
    'white-space': 'pre',
    position: 'fixed',
    left: 0,
    top: 0
  });

  showCode = function(code, x, y) {
    $('#thecode').show();
    $('#thecode').text(code);
    return positionCode(x, y);
  };

  hideCode = function() {
    return $('#thecode').hide();
  };

  positionCode = function(x, y) {
    return $('#thecode').css({
      left: x,
      top: y
    });
  };

  nodes = $('.node');

  _.each(nodes, function(node) {
    var nodeName;
    nodeName = $(node).find('title').text();
    $(node).mousemove(function(e) {
      return showCode(Codes[nodeName], e.clientX, e.clientY);
    });
    return $(node).mouseleave(function() {
      return hideCode();
    });
  });

  $('svg title').remove();

  downAt = null;

  $('svg').mousedown(function(e) {
    var x, y;
    x = e.pageX;
    y = e.pageY;
    return downAt = {
      x: x,
      y: y
    };
  });

  $('svg').mousemove(function(e) {
    var delta, x, y;
    if (!downAt) {
      return;
    }
    x = e.pageX;
    y = e.pageY;
    delta = {
      x: x - downAt.x,
      y: y - downAt.y
    };
    window.scrollBy(-delta.x, -delta.y);
    return false;
  });

  $('svg').mouseup(function(e) {
    return downAt = null;
  });

  $('svg').mouseleave(function(e) {
    return downAt = null;
  });

}).call(this);
</script></html>