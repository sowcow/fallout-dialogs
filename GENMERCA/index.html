<!DOCTYPE html><html><head><title>GENMERCA</title><meta charset="utf-8" /></head><body><svg width="624pt" height="722pt"
 viewBox="0.00 0.00 624.00 722.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 718.399)">
<title>GENMERCA</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-718.399 620,-718.399 620,4 -4,4"/>
<!-- start -->
<g id="node1" class="node"><title>start</title>
<ellipse fill="#ffffff" stroke="#000000" cx="135" cy="-696.399" rx="27" ry="18"/>
</g>
<!-- critter_p_proc -->
<g id="node2" class="node"><title>critter_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="27" cy="-623.399" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;critter_p_proc -->
<g id="edge1" class="edge"><title>start&#45;&gt;critter_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M116.188,-683.032C98.9979,-671.731 73.3816,-654.891 54.0067,-642.153"/>
<polygon fill="#555555" stroke="#555555" points="55.8753,-639.193 45.5966,-636.625 52.03,-645.043 55.8753,-639.193"/>
</g>
<!-- destroy_p_proc -->
<g id="node3" class="node"><title>destroy_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="99" cy="-623.399" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;destroy_p_proc -->
<g id="edge2" class="edge"><title>start&#45;&gt;destroy_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M126.65,-678.932C122.288,-670.329 116.853,-659.609 111.959,-649.956"/>
<polygon fill="#555555" stroke="#555555" points="114.948,-648.113 107.304,-640.777 108.705,-651.279 114.948,-648.113"/>
</g>
<!-- pickup_p_proc -->
<g id="node4" class="node"><title>pickup_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="171" cy="-623.399" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;pickup_p_proc -->
<g id="edge3" class="edge"><title>start&#45;&gt;pickup_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M143.35,-678.932C147.712,-670.329 153.147,-659.609 158.041,-649.956"/>
<polygon fill="#555555" stroke="#555555" points="161.295,-651.279 162.696,-640.777 155.052,-648.113 161.295,-651.279"/>
</g>
<!-- talk_p_proc -->
<g id="node5" class="node"><title>talk_p_proc</title>
<ellipse fill="#ffffff" stroke="#000000" cx="243" cy="-623.399" rx="27" ry="18"/>
</g>
<!-- start&#45;&gt;talk_p_proc -->
<g id="edge4" class="edge"><title>start&#45;&gt;talk_p_proc</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M153.812,-683.032C171.002,-671.731 196.618,-654.891 215.993,-642.153"/>
<polygon fill="#555555" stroke="#555555" points="217.97,-645.043 224.403,-636.625 214.125,-639.193 217.97,-645.043"/>
</g>
<!-- flee_dude -->
<g id="node6" class="node"><title>flee_dude</title>
<ellipse fill="#ffffff" stroke="#000000" cx="27" cy="-541.529" rx="27" ry="18"/>
</g>
<!-- critter_p_proc&#45;&gt;flee_dude -->
<g id="edge5" class="edge"><title>critter_p_proc&#45;&gt;flee_dude</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M27,-605.068C27,-594.741 27,-581.407 27,-569.705"/>
<polygon fill="#555555" stroke="#555555" points="30.5001,-569.551 27,-559.551 23.5001,-569.551 30.5001,-569.551"/>
</g>
<!-- GenMercA00 -->
<g id="node7" class="node"><title>GenMercA00</title>
<ellipse fill="#ffffff" stroke="#000000" cx="243" cy="-541.529" rx="96.7474" ry="26.7407"/>
<text text-anchor="middle" x="243" y="-545.329" font-family="Times,serif" font-size="14.00">Hello! What can I do</text>
<text text-anchor="middle" x="243" y="-530.329" font-family="Times,serif" font-size="14.00"> for you?</text>
</g>
<!-- talk_p_proc&#45;&gt;GenMercA00 -->
<g id="edge6" class="edge"><title>talk_p_proc&#45;&gt;GenMercA00</title>
<path fill="none" stroke="#555555" stroke-dasharray="1,5" d="M243,-605.068C243,-597.335 243,-587.915 243,-578.757"/>
<polygon fill="#555555" stroke="#555555" points="246.5,-578.633 243,-568.633 239.5,-578.633 246.5,-578.633"/>
</g>
<!-- GenMercA01 -->
<g id="node8" class="node"><title>GenMercA01</title>
<ellipse fill="#ffffff" stroke="#000000" cx="243" cy="-430.659" rx="27" ry="18"/>
</g>
<!-- GenMercA00&#45;&gt;GenMercA01 -->
<g id="edge7" class="edge"><title>GenMercA00&#45;&gt;GenMercA01</title>
<path fill="none" stroke="#880099" d="M243,-514.452C243,-497.732 243,-476.061 243,-459.084"/>
<polygon fill="#880099" stroke="#880099" points="246.5,-458.705 243,-448.705 239.5,-458.705 246.5,-458.705"/>
<text text-anchor="middle" x="283.5" y="-477.959" font-family="Times,serif" font-size="14.00" fill="#880099">Who are you?</text>
</g>
<!-- GenMercA02 -->
<g id="node9" class="node"><title>GenMercA02</title>
<ellipse fill="#ffffff" stroke="#000000" cx="393" cy="-328.659" rx="27" ry="18"/>
</g>
<!-- GenMercA00&#45;&gt;GenMercA02 -->
<g id="edge8" class="edge"><title>GenMercA00&#45;&gt;GenMercA02</title>
<path fill="none" stroke="#00995c" d="M297.213,-518.989C308.282,-512.909 319.215,-505.488 328,-496.659 366.747,-457.718 382.966,-393.048 389.301,-356.667"/>
<polygon fill="#00995c" stroke="#00995c" points="392.76,-357.202 390.9,-346.772 385.85,-356.085 392.76,-357.202"/>
<text text-anchor="middle" x="436" y="-426.959" font-family="Times,serif" font-size="14.00" fill="#00995c">What are you doing?</text>
</g>
<!-- GenMercA03 -->
<g id="node10" class="node"><title>GenMercA03</title>
<ellipse fill="#ffffff" stroke="#000000" cx="566" cy="-430.659" rx="33.5952" ry="18"/>
<text text-anchor="middle" x="566" y="-426.959" font-family="Times,serif" font-size="14.00">Aack!</text>
</g>
<!-- GenMercA00&#45;&gt;GenMercA03 -->
<g id="edge9" class="edge"><title>GenMercA00&#45;&gt;GenMercA03</title>
<path fill="none" stroke="#992f00" d="M315.076,-523.539C344.189,-516.114 377.945,-506.788 408,-496.659 451.558,-481.978 500.279,-461.253 531.95,-447.18"/>
<polygon fill="#992f00" stroke="#992f00" points="533.508,-450.318 541.207,-443.04 530.65,-443.928 533.508,-450.318"/>
<text text-anchor="middle" x="551.5" y="-485.459" font-family="Times,serif" font-size="14.00" fill="#992f00">Yeah, gimme everythi</text>
<text text-anchor="middle" x="551.5" y="-470.459" font-family="Times,serif" font-size="14.00" fill="#992f00">ng you&#39;ve got.</text>
</g>
<!-- GenMercAEnd -->
<g id="node11" class="node"><title>GenMercAEnd</title>
<ellipse fill="#ffffff" stroke="#000000" cx="154" cy="-122.329" rx="27" ry="18"/>
</g>
<!-- GenMercA00&#45;&gt;GenMercAEnd -->
<g id="edge10" class="edge"><title>GenMercA00&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#020099" d="M149.427,-534.262C120.402,-528.132 90.2342,-516.902 68,-496.659 32.4523,-464.294 40.1165,-442.043 32,-394.659 15.0482,-295.695 94.1937,-190.57 133.264,-145.709"/>
<polygon fill="#020099" stroke="#020099" points="136.041,-147.852 140.06,-138.049 130.805,-143.206 136.041,-147.852"/>
<text text-anchor="middle" x="46" y="-375.959" font-family="Times,serif" font-size="14.00" fill="#020099">Lub!</text>
</g>
<!-- GenMercA00&#45;&gt;GenMercAEnd -->
<g id="edge11" class="edge"><title>GenMercA00&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#2a9900" d="M204.737,-516.725C168.225,-491.521 115.545,-448.031 93,-394.659 56.5407,-308.347 110.411,-196.974 138.613,-148.135"/>
<polygon fill="#2a9900" stroke="#2a9900" points="141.803,-149.617 143.877,-139.227 135.776,-146.056 141.803,-149.617"/>
<text text-anchor="middle" x="157.5" y="-383.459" font-family="Times,serif" font-size="14.00" fill="#2a9900">Yeah, gimme everythi</text>
<text text-anchor="middle" x="157.5" y="-368.459" font-family="Times,serif" font-size="14.00" fill="#2a9900">ng you&#39;ve got.</text>
</g>
<!-- GenMercA01&#45;&gt;GenMercA02 -->
<g id="edge12" class="edge"><title>GenMercA01&#45;&gt;GenMercA02</title>
<path fill="none" stroke="#990057" d="M242.73,-412.5C243.471,-397.719 247.005,-376.891 260,-364.659 290.021,-336.402 311.493,-358.446 351,-346.659 354.42,-345.638 357.948,-344.446 361.437,-343.174"/>
<polygon fill="#990057" stroke="#990057" points="362.983,-346.328 371.047,-339.457 360.458,-339.8 362.983,-346.328"/>
<text text-anchor="middle" x="320" y="-375.959" font-family="Times,serif" font-size="14.00" fill="#990057">What are you doing?</text>
</g>
<!-- GenMercA01&#45;&gt;GenMercAEnd -->
<g id="edge13" class="edge"><title>GenMercA01&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#008499" d="M238.088,-412.753C223.379,-362.125 179.599,-211.437 161.727,-149.927"/>
<polygon fill="#008499" stroke="#008499" points="165.048,-148.81 158.897,-140.183 158.326,-150.763 165.048,-148.81"/>
<text text-anchor="middle" x="279.5" y="-332.459" font-family="Times,serif" font-size="14.00" fill="#008499">Hello! What can I do</text>
<text text-anchor="middle" x="279.5" y="-317.459" font-family="Times,serif" font-size="14.00" fill="#008499"> for you?</text>
</g>
<!-- GenMercA02&#45;&gt;GenMercAEnd -->
<g id="edge15" class="edge"><title>GenMercA02&#45;&gt;GenMercAEnd</title>
<path fill="none" stroke="#550099" d="M371.017,-317.961C364.638,-315.367 357.61,-312.715 351,-310.659 315.787,-299.703 300.553,-313.312 270,-292.659 242.142,-273.828 192.315,-190.734 168.05,-148.363"/>
<polygon fill="#550099" stroke="#550099" points="170.991,-146.454 163.004,-139.493 164.907,-149.916 170.991,-146.454"/>
<text text-anchor="middle" x="330.5" y="-281.459" font-family="Times,serif" font-size="14.00" fill="#550099">Hello! What can I do</text>
<text text-anchor="middle" x="330.5" y="-266.459" font-family="Times,serif" font-size="14.00" fill="#550099"> for you?</text>
</g>
<!-- GenMercA04 -->
<g id="node12" class="node"><title>GenMercA04</title>
<ellipse fill="#ffffff" stroke="#000000" cx="403" cy="-122.329" rx="96.3333" ry="122.159"/>
<text text-anchor="middle" x="403" y="-193.629" font-family="Times,serif" font-size="14.00">Sorry, but I don&#39;t t</text>
<text text-anchor="middle" x="403" y="-178.629" font-family="Times,serif" font-size="14.00">hink I can trust you</text>
<text text-anchor="middle" x="403" y="-163.629" font-family="Times,serif" font-size="14.00">.</text>
<text text-anchor="middle" x="403" y="-148.629" font-family="Times,serif" font-size="14.00">&#45;&#45;&#45;</text>
<text text-anchor="middle" x="403" y="-133.629" font-family="Times,serif" font-size="14.00">Sorry, this co</text>
<text text-anchor="middle" x="403" y="-118.629" font-family="Times,serif" font-size="14.00">mpany is already ful</text>
<text text-anchor="middle" x="403" y="-103.629" font-family="Times,serif" font-size="14.00">l.</text>
<text text-anchor="middle" x="403" y="-88.6295" font-family="Times,serif" font-size="14.00">&#45;&#45;&#45;</text>
<text text-anchor="middle" x="403" y="-73.6295" font-family="Times,serif" font-size="14.00">Sorry, this c</text>
<text text-anchor="middle" x="403" y="-58.6295" font-family="Times,serif" font-size="14.00">ompany is already fu</text>
<text text-anchor="middle" x="403" y="-43.6295" font-family="Times,serif" font-size="14.00">ll.</text>
</g>
<!-- GenMercA02&#45;&gt;GenMercA04 -->
<g id="edge14" class="edge"><title>GenMercA02&#45;&gt;GenMercA04</title>
<path fill="none" stroke="#998200" d="M393.835,-310.589C394.498,-297.054 395.491,-276.755 396.583,-254.448"/>
<polygon fill="#998200" stroke="#998200" points="400.08,-254.587 397.073,-244.428 393.089,-254.245 400.08,-254.587"/>
<text text-anchor="middle" x="454.5" y="-281.459" font-family="Times,serif" font-size="14.00" fill="#998200">Do you mind if I joi</text>
<text text-anchor="middle" x="454.5" y="-266.459" font-family="Times,serif" font-size="14.00" fill="#998200">n you?</text>
</g>
</g>
</svg>
<script>window.Codes = {"start":"if (not(initialized)) then begin\n  critter_add_trait(self_obj, 1, 6, 2);\n  critter_add_trait(self_obj, 1, 5, 50);\n  name_index := 105 + global_var(335);\n  job_index := 109 + global_var(335);\n  hostile := global_var(334);\n  set_global_var(335, global_var(335) + 1);\n  initialized := 1;\nend\nif (script_action == 12) then begin\n  call critter_p_proc;\nend\nelse begin\n  if (script_action == 18) then begin\n    call destroy_p_proc;\n  end\n  else begin\n    if (script_action == 4) then begin\n      call pickup_p_proc;\n    end\n    else begin\n      if (script_action == 11) then begin\n        call talk_p_proc;\n      end\n    end\n  end\nend\n","critter_p_proc":"if (scared and (tile_distance_objs(self_obj, dude_obj) < 8)) then begin\n  call flee_dude;\nend\nelse begin\n  if (hostile) then begin\n    hostile := 0;\n    scared := 1;\n    attack_complex(dude_obj, 0, 1, 0, 0, 30000, 0, 0);\n  end\nend\n","destroy_p_proc":"if (source_obj == dude_obj) then begin\n  set_global_var(334, 1);\n  if (source_obj == dude_obj) then begin\n    if (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1))) then begin\n      set_global_var(156, 1);\n      set_global_var(157, 0);\n    end\n    if (((global_var(160) + global_var(159)) >= 25) and ((global_var(160) > (3 * global_var(159))) or (global_var(157) == 1))) then begin\n      set_global_var(157, 1);\n      set_global_var(156, 0);\n    end\n    set_global_var(159, global_var(159) + 1);\n    if ((global_var(159) % 2) == 0) then begin\n      set_global_var(155, global_var(155) - 1);\n    end\n  end\nend\n","pickup_p_proc":"if (scared == 0) then begin\n  hostile := 1;\n  set_global_var(334, 1);\nend\n","talk_p_proc":"if (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1))) then begin\n  set_global_var(156, 1);\n  set_global_var(157, 0);\nend\nif (scared) then begin\n  float_msg(self_obj, message_str(669, random(100, 105)), 2);\nend\nelse begin\n  start_gdialog(752, self_obj, 4, -1, -1);\n  gsay_start;\n  call GenMercA00;\n  gsay_end;\n  end_dialogue;\nend\n","GenMercA00":"gsay_reply(752, 100);\ngiq_option(4, 752, 101, GenMercA01, 50);\ngiq_option(4, 752, 102, GenMercA02, 50);\nif (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1))) then begin\n  giq_option(4, 752, 103, GenMercA03, 51);\nend\ngiq_option(-3, 752, 104, GenMercAEnd, 50);\ngiq_option(4, 634, 103, GenMercAEnd, 50);\n","GenMercA01":"gsay_reply(752, name_index);\ngiq_option(4, 752, 102, GenMercA02, 50);\ngiq_option(4, 634, 100, GenMercAEnd, 50);\n","GenMercA02":"gsay_reply(752, job_index);\ngiq_option(4, 752, 114, GenMercA04, 50);\ngiq_option(4, 634, 100, GenMercAEnd, 50);\n","GenMercA03":"scared := 1;\ngsay_message(752, 113, 51);\n","GenMercA04":"if (((global_var(160) + global_var(159)) >= 25) and ((global_var(159) > (2 * global_var(160))) or (global_var(156) == 1)) or (global_var(158) > 2) or (global_var(155) < -20)) then begin\n  gsay_message(752, 117, 51);\nend\nelse begin\n  if (is_success(roll_vs_skill(dude_obj, 14, 0))) then begin\n    gsay_message(752, 116, 50);\n  end\n  else begin\n    gsay_message(752, 116, 50);\n  end\nend\n","GenMercAEnd":"[]","flee_dude":"variable LVar0 := 0;\nvariable LVar1 := 0;\nvariable LVar2 := 0;\nwhile(LVar1 < 5) do begin\n  if (tile_distance(tile_num(dude_obj), tile_num_in_direction(tile_num(self_obj), LVar1, 3)) > LVar2) then begin\n    LVar0 := tile_num_in_direction(tile_num(self_obj), LVar1, 3);\n    LVar2 := tile_distance(tile_num(dude_obj), LVar0);\n  end\n  LVar1 := LVar1 + 1;\nend\nanimate_move_obj_to_tile(self_obj, LVar0, 1);\n"}</script></body><script src="../jquery.js"></script><script src="../underscore.js"></script><script type="text/javascript">(function() {
  var downAt, hideCode, nodes, positionCode, showCode;

  $('svg').attr('unselectable', 'on').css({
    '-moz-user-select': '-moz-none',
    '-moz-user-select': 'none',
    '-o-user-select': 'none',
    '-khtml-user-select': 'none',
    '-webkit-user-select': 'none',
    '-ms-user-select': 'none',
    'user-select': 'none'
  }).bind('selectstart', function() {
    return false;
  });

  $('<div/>', {
    id: 'thecode'
  }).appendTo('body');

  $('#thecode').css({
    'pointer-events': 'none',
    background: 'white',
    padding: '1em',
    outline: 'solid gray 1px',
    'white-space': 'pre',
    position: 'fixed',
    left: 0,
    top: 0
  });

  showCode = function(code, x, y) {
    $('#thecode').show();
    $('#thecode').text(code);
    return positionCode(x, y);
  };

  hideCode = function() {
    return $('#thecode').hide();
  };

  positionCode = function(x, y) {
    return $('#thecode').css({
      left: x,
      top: y
    });
  };

  nodes = $('.node');

  _.each(nodes, function(node) {
    var nodeName;
    nodeName = $(node).find('title').text();
    $(node).mousemove(function(e) {
      return showCode(Codes[nodeName], e.clientX, e.clientY);
    });
    return $(node).mouseleave(function() {
      return hideCode();
    });
  });

  $('svg title').remove();

  downAt = null;

  $('svg').mousedown(function(e) {
    var x, y;
    x = e.pageX;
    y = e.pageY;
    return downAt = {
      x: x,
      y: y
    };
  });

  $('svg').mousemove(function(e) {
    var delta, x, y;
    if (!downAt) {
      return;
    }
    x = e.pageX;
    y = e.pageY;
    delta = {
      x: x - downAt.x,
      y: y - downAt.y
    };
    window.scrollBy(-delta.x, -delta.y);
    return false;
  });

  $('svg').mouseup(function(e) {
    return downAt = null;
  });

  $('svg').mouseleave(function(e) {
    return downAt = null;
  });

}).call(this);
</script></html>